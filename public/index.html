<!doctype html>
<html ng-app="gameDay">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Work out which is the best NBA basketball game to watch without spoiling the result.">
	<title>NBA game of the day</title>

    <link rel="stylesheet" href="//fonts.typotheque.com/WF-021117-002395.css" type="text/css" />
	<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css">
	<link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css">

    <style>
		html 					{ overflow-y:scroll; }
		body 					{
            padding-top:50px;
            background-image:   url('/img/clipsfloor.png');
            background-repeat:  repeat;
        }

        .pageHeader {
            background-image:   url('/img/green.jpg');
            background-repeat:  repeat;
            color:  darkorange;
        }
        .pageHeaderTxt {
            border-bottom-color: #DFDFDF;
            border-bottom-style: solid;
            border-bottom-width: 1px;
            color: #FCF8F9;
            display: inline-block;
            font-family: "Jigsaw Light", sans-serif;
            font-size: 58px;
            font-stretch: normal;
            font-style: normal;
            font-weight: 400;
            letter-spacing: 5.8px;
            line-height: 69.6px;
            text-align: center;
            text-shadow: #444 -1px -1px 0px, #444 1px -1px 1px, #444 -1px 1px 1px, #444 1px 1px 0px;
            text-transform: uppercase;
            word-wrap: break-word;
        }

        @media (min-width: 901px) {
            .eve,.blk {
                width: 22%;
                width: -webkit-calc(25% - 20px);
                width: -moz-calc(25% - 20px);
                width: -ms-calc(25% - 20px);
                width: -o-calc(25% - 20px);
                width: calc(25% - 20px);
            }
        }

        @media (min-width: 601px) and (max-width: 900px) {
            .eve,.blk {
                width: 30%;
                width: -webkit-calc(33.33% - 20px);
                width: -moz-calc(33.33% - 20px);
                width: -ms-calc(33.33% - 20px);
                width: -o-calc(33.33% - 20px);
                width: calc(33.33% - 20px);
            }
        }

        /*@media (min-width: 601px) and (max-width: 700px) {*/
            /*.m800 .blogTiles .ele{*/
                /*width: 45%;*/
                /*width: -webkit-calc(50% - 20px);*/
                /*width: -moz-calc(50% - 20px);*/
                /*width: -ms-calc(50% - 20px);*/
                /*width: -o-calc(50% - 20px);*/
                /*width: calc(50% - 20px);*/
            /*}*/
        /*}*/

        @media (max-width: 600px) {
            .eve,.blk {
                width: 95%;
                width: -webkit-calc(100% - 20px);
                width: -moz-calc(100% - 20px);
                width: -ms-calc(100% - 20px);
                width: -o-calc(100% - 20px);
                width: calc(100% - 20px);
            }
        }

        .eve,.blk {
            display: inline-block;
            vertical-align: top;
            margin: 10px;
            border: 1px solid #eee;
            box-shadow: 0 -60px 60px -60px rgba(0,0,0,.1) inset;
            box-sizing: border-box;
            border-radius: 3px;
            background: rgba(102, 102, 102, 0.4);
            color:white;
        }

        .upcoming {
            background: rgba(136, 235, 255, 0.4);
        }

        .textButton {
            padding: 5px 15px 10px;
            margin-left: 10px;
            margin-bottom: 10px;
            font-size: 18px;
            color: #334;
            text-shadow: 1px 1px 0 #fff;
            background: rgba(240, 240,240,.6);
            border-radius: 2px 2px 0 0;
            white-space:nowrap;
            display:inline-block;
            vertical-align: middle;
        }

        .eve .title,.blk .title{
            width: 100%;
            padding: 10px;
            font-size: 18px;
            color: #334;
            text-shadow: 1px 1px 0 #fff;
            background: rgba(240, 240,240,.6);
            border-radius: 2px 2px 0 0;
        }

        .eve .type,.blk .type{
            font-size: 10px;
            padding: 10px 10px 10px;
        }
        .eve .summary,.blk .summary {
            padding: 15px 10px;
            font-size:1.4em;
        }
        .eve .summary p,.blk .summary p {
            margin: 1em 0;
            line-height: 120%;
        }

        .eve .note,.blk .note{padding: 10px 10px;font-size:0.8em;}

        .userVoted {
            border-bottom-width:2px;
            border-bottom-style:solid;
            border-bottom-color:darkslategrey;
        }


    </style>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.18/angular.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.18/angular-route.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/masonry/3.1.5/masonry.pkgd.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.6.0/underscore-min.js"></script>
    <script src="//desandro.github.io/imagesloaded/imagesloaded.pkgd.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/lodash.js/1.3.1/lodash.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.8.4/moment.min.js"></script>

    <!-- offline dev -->
    <!--<script src="js/lib/jquery.min.js"></script>-->
    <!--<script src="js/lib/angular.min.js"></script>-->
    <!--<script src="js/lib/masonry.pkgd.min.js"></script>-->


	<script src="js/controllers/main.js"></script>
	<script src="js/services/teams.js"></script>
    <script src="js/core.js"></script>


</head>
<body ng-controller="mainController">
	<div class="container">

		<div class="jumbotron text-center pageHeader" onclick="setImgBg();">
			<h1 class="pageHeaderTxt">NBA game of the day<span class="label label-info"></span></h1>
		</div>

		<div class="row">
            <div style="margin-bottom: 10px;">
                <select ng-model="currentTeam" ng-options="team.full_name for team in teams" style="margin:22px 9px 20px;">
                    <option value=""> Team </option>
                </select>
                <select ng-model="currentRating" style="margin:22px 9px 20px;" >
                    <option value=""> Rating </option>
                    <option ng-repeat="rating in ratings" value="{{rating}}">{{rating}}</option>
                </select>
                <span ng-click="toggleShowGamesWithAussies()" class="textButton" ng-show="onlyWithOz == false"><img src="img/aus.png" title="Show games with Australians" alt="Show games with Australians"/> With Australians</span>
                <span ng-click="toggleShowGamesWithAussies()" class="textButton" ng-show="onlyWithOz == true"><img src="img/aus.png" title="Show games with Australians" alt="Show games with Australians"/> All</span>
                <span ng-click="toggleShowUpcoming()" class="textButton" ng-show="showUpcoming == false">Show upcoming</span>
                <span ng-click="toggleShowUpcoming()" class="textButton" ng-show="showUpcoming == true">Hide upcoming</span>
                <span ng-click="showBest()" class="textButton" ng-show="showingBest == false">Best by day</span>
                <span ng-click="showBestEver()" class="textButton" ng-show="showingBest == false">Best so far</span>
                <span ng-click="showWithChatter()" class="textButton" ng-show="currentChatter == 10000">High Chatter</span>
                <span ng-click="showAllChatter()" class="textButton" ng-hide="currentChatter == 10000">All Games</span>
                <span ng-click="showAll(true)" class="textButton" ng-show="showingBest == true || (selectedEventId && selectedEventId!='')">All Games</span>
                <!--<select ng-model="currentChatter" style="margin-left:9px" >-->
                    <!--<option value="500"> Chatter </option>-->
                    <!--<option value="1"> Lots </option>-->
                <!--</select>-->
            </div>

            <div class="eveContainer" ng-show="showUpcoming == true">
                <div class="eve upcoming" ng-repeat="event in upcomingEvents | orderBy:'event_start_date_time':false | limitTo:upcomingCount">
                    <div class="title">
                        <span ng-click="setCurrentTeam(event.home_team_id)">{{teamsById[event.home_team_id].full_name}}</span>
                        <img ng-src="img/logos/{{teamsById[event.home_team_id].abbreviation}}.gif" alt="" style="max-height: 40px"/>
                        &#64; <br/>
                        <span ng-click="setCurrentTeam(event.away_team_id)">{{teamsById[event.away_team_id].full_name}}</span>
                        <img ng-src="img/logos/{{teamsById[event.away_team_id].abbreviation}}.gif" alt="" style="max-height: 40px"/>
                    </div>
                    <div class="note">
                        {{event.startingIn}}
                    </div>
                    <div class="type">
                        {{event.event_start_date_time | date:'mediumDate'}}
                    </div>
                    <div class="note" ng-click="gotoGame(event.event_id)">
                        Share
                    </div>
                </div>
                <div class="blk" ng-click="showMoreUpcoming()">
                    <div class="title" style="background-color: lightblue">
                        More Upcoming
                    </div>
                </div>
            </div>

            <div class="eveContainer" ng-if="selectedEventId">
                <div class="eve upcoming" ng-if="selectedEventId==event.event_id" ng-repeat="event in upcomingEvents | orderBy:'event_start_date_time':false | limitTo:upcomingCount">
                    <div class="title">
                        <span ng-click="setCurrentTeam(event.home_team_id)">{{teamsById[event.home_team_id].full_name}}</span>
                        <img ng-src="img/logos/{{teamsById[event.home_team_id].abbreviation}}.gif" alt="" style="max-height: 40px"/>
                        &#64; <br/>
                        <span ng-click="setCurrentTeam(event.away_team_id)">{{teamsById[event.away_team_id].full_name}}</span>
                        <img ng-src="img/logos/{{teamsById[event.away_team_id].abbreviation}}.gif" alt="" style="max-height: 40px"/>
                    </div>
                    <div class="note">
                        {{event.startingIn}}
                    </div>
                    <div class="type">
                        {{event.event_start_date_time | date:'mediumDate'}}
                    </div>
                    <div class="note" ng-click="gotoGame(event.event_id)">
                        Share
                    </div>
                </div>
            </div>

            <div class="eveContainer"
                    masonry-wall-dir=".eve"
                    masonry-wall-options="{
                            transitionDuration: '0.4s'
                        }"
                    >
                <div class="eve" ng-repeat="event in events | filter:matchTeam | orderBy:'event_start_date_time':true | limitTo:eventCount" custom-directive masonry-item-dir>
                    <div class="title">
                        <span ng-click="setCurrentTeam(event.home_team_id)">{{teamsById[event.home_team_id].full_name}}</span>
                        <img ng-src="img/logos/{{teamsById[event.home_team_id].abbreviation}}.gif" alt="" style="max-height: 40px"/>
                        &#64; <br/>
                        <span ng-click="setCurrentTeam(event.away_team_id)">{{teamsById[event.away_team_id].full_name}}</span>
                        <img ng-src="img/logos/{{teamsById[event.away_team_id].abbreviation}}.gif" alt="" style="max-height: 40px"/>
                    </div>
                    <div class="summary" title="{{event.twitterScore}} mentions in Twitter" style="float:right" ng-if="event.twitterScore" ng-click="showTweets(event)">
                        <img src="img/twitter2.png" alt="Twitter Mentions" title="Twitter Mentions" style="width: 30px"/>
                        {{event.twitterScore}}
                    </div>
                    <div class="summary" title="Exact Rating: {{event.pointsBasedScore}}">
                        Rating {{event.pointsBasedRating}}
                    </div>
                    <div class="note" ng-if="event.finalScore" style="float: right">
                        <span ng-click="event.showScore = true" ng-hide="event.showScore == true">Game Score</span>
                        <span ng-if="event.showScore == true">
                            {{event.finalScore}}
                        </span>
                    </div>
                    <div class="note" ng-click="gotoGame(event.event_id)">
                        Share
                        <!--<div ng-class="{userVoted:event.userVoted == true}" style="width:65px;padding-bottom:5px;">-->
                            <!--<span ng-click="likeEvent(event)" >-->
                                <!--<img src="img/up.png" alt="like" title="like" style="width: 20px"/>-->
                                <!--<span ng-show="event.dislikeCount > 0 || event.likeCount > 0">{{event.likeCount}}</span>-->
                            <!--</span>-->
                            <!--<span ng-click="dislikeEvent(event)">-->
                                <!--<img src="img/down.png" alt="Dislike" title="Dislike" style="width: 20px"/>-->
                                <!--<span ng-show="event.dislikeCount > 0 || event.likeCount > 0">{{event.dislikeCount}}</span>-->
                            <!--</span>-->
                        <!--</div>-->
                    </div>
                    <div class="type" style="float: right">
                        {{event.event_start_date_time | date:'mediumDate'}}
                    </div>
                    <div class="note" ng-if="event.aussies">
                        <span ng-click="showOzDetail(event)" ng-hide="event.showOzDetail == true">
                            <img src="img/aus.png" title="Show Aussie player details" alt="Show Aussie player details"/>
                        </span>
                        <span ng-if="event.showOzDetail == true" style="padding:0 10px 0 10px;">
                            <div ng-repeat="player in event.aussies">
                                <br/>
                                {{player.name}}: {{player.points}} points
                                <span ng-if="player.assists > 0">/ {{player.assists}} assists</span>
                                <span ng-if="player.turnovers > 0">/ {{player.turnovers}} turnovers</span>
                                <span ng-if="player.steals > 0">/ {{player.steals}} steals</span>
                                <span ng-if="player.blocks > 0">/ {{player.blocks}} blocks</span>
                                in {{player.minutes}}mins.
                                Shooting at {{player.field_goal_percentage*100 | number : 0}}%
                                <span ng-if="player.three_point_percentage > 0">({{player.three_point_percentage*100 | number : 0}}% from 3)</span>.
                                <br/>
                            </div>
                        </span>
                    </div>

                </div>
            </div>

            <div class="blk" ng-click="showMore()">
                <div class="title" style="background-color: lightblue">
                    More
                </div>
            </div>
            <div class="blk" onclick="moreInfo()">
                <div class="title" style="background-color: lightgreen">
                    Info
                </div>
                <div class="summary" id="infoPanel" style="display: none">
                    The rating is calculated automatically based on points difference and lead changes throughout the game.  It is intended to
                    give an indication of how enjoyable the game will be without giving away the result.
                </div>
            </div>
		</div>

        <div ng-if="tweets">
            <div ng-repeat="tweet in tweets">
                {{tweet.created}}
                {{tweet.searchParam}}
                {{tweet.text}}
            </div>
        </div>

	</div>
    <script>

        var imgArray = [];
        imgArray.push('/img/green.jpg');
        imgArray.push('/img/green2.jpg');
        imgArray.push('/img/green3.jpg');
        imgArray.push('/img/green4.jpg');
        imgArray.push('/img/jump.jpg');
        imgArray.push('/img/bledsoe.jpg');

        var psnArray = [];
        psnArray.push('center right');
        psnArray.push('center left');
        psnArray.push('top');
        psnArray.push('bottom');
        psnArray.push('top right');
        psnArray.push('bottom left');

        function setImgBg() {
            var idxImg = Math.floor(Math.random() * 5);
            var idxPos = Math.floor(Math.random() * 6);
            var ph = $('.pageHeader');
            ph.css('background-position','url(' + psnArray[idxPos] + ')');
            ph.css('background-image','url(' + imgArray[idxImg] + ')');
        }
        setInterval(function(){ setImgBg(); }, 7000);

        function moreInfo() {
            $("#infoPanel").show();
            setTimeout(function(){ $("#infoPanel").hide(); }, 10000);
        }

        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-57143956-1', 'auto');
        ga('send', 'pageview');
    </script>
</body>
</html>
